{% extends "base.html" %}

{% block head %}
{{ super() }}
<!-- Dodaj słownik tłumaczeń dla JavaScript -->
<script>
    window.translations = {
        'Allergens': '{{ _("Allergens") }}',
        'Price': '{{ _("Price") }}',
        'PLN': '{{ _("PLN") }}',
        'Total': '{{ _("Total") }}',
        'Failed to load menu': '{{ _("Failed to load menu") }}',
        'Maximum available quantity reached': '{{ _("Maximum available quantity reached") }}',
        'Order Summary': '{{ _("Order Summary") }}',
        'Quantity': '{{ _("Quantity") }}',
        'Failed to load order summary': '{{ _("Failed to load order summary") }}',
        'Failed to change language': '{{ _("Failed to change language") }}',
        'Cancel': '{{ _("Cancel") }}',
        'Snacks': '{{ _("Snacks") }}',
        'Drinks': '{{ _("Drinks") }}',
        'Coffee': '{{ _("Coffee") }}',
        'Take Away': '{{ _("Take Away") }}',
        'Sauces': '{{ _("Sauces") }}',
        'Summary': '{{ _("Summary") }}',
        'Estimated waiting time %(time)d min': '{{ _("Estimated waiting time %(time)d min") }}',
        'Are you sure you want to cancel your order?': '{{ _("Are you sure you want to cancel your order?") }}',
        'Order cancelled successfully': '{{ _("Order cancelled successfully") }}',
        'Failed to cancel order': '{{ _("Failed to cancel order") }}'
    };
</script>
{% endblock %}

{% block content %}
<div class="order-container" data-order-id="{{ order_id }}" data-aps-id="{{ aps_id }}">
    <!-- Górna sekcja -->
    <header class="order-top-section">
        <div class="order-logo-section">
            <img src="{{ url_for('static', filename='images/MunchiesLogoPlain.svg') }}" alt="Munchies Logo" class="order-logo">
        </div>
        <div class="order-flags-section">
            <div class="order-flags">
                <button class="order-flag-button">
                    <img src="{{ url_for('static', filename='images/plFlag.png') }}" alt="pl" class="order-flag-icon">
                </button>
                <button class="order-flag-button">
                    <img src="{{ url_for('static', filename='images/angFlag.png') }}" alt="en" class="order-flag-icon">
                </button>
                <button class="order-flag-button">
                    <img src="{{ url_for('static', filename='images/uaFlag.png') }}" alt="uk" class="order-flag-icon">
                </button>
            </div>
            <p class="order-estimated-time">
                {{ _('Estimated waiting time %(time)d min', time=estimated_waiting_time) }}
            </p>
        </div>
    </header>

    <!-- Środkowa sekcja -->
    <main class="order-middle-section">
        <!-- Pasek kategorii -->
        <nav class="order-category-bar">
            {% set categories = [
                ('snack', _('Snacks')),
                ('drink', _('Drinks')),
                ('coffee', _('Coffee')),
                ('take_away_box', _('Take Away')),
                ('sauce', _('Sauces')),
                ('sum', _('Summary'))
            ] %}
            {% for category_id, category_name in categories %}
                <button class="order-category-button {% if loop.first %}active{% endif %}" data-category="{{ category_id }}">
                    {{ category_name }}
                </button>
            {% endfor %}
        </nav>

        <!-- Lista produktów -->
        <div class="order-product-list">
            <!-- Lista produktów będzie generowana dynamicznie przez JavaScript -->
        </div>
    </main>

    <!-- Dolna sekcja -->
    <footer class="order-bottom-section">
        <button id="cancel-order" 
                class="order-action-button order-cancel-button"
                data-template="{{ _('Cancel') }}"
                data-confirm-message="{{ _('Are you sure you want to cancel your order?') }}"
                data-success-message="{{ _('Order cancelled successfully') }}"
                data-error-message="{{ _('Failed to cancel order') }}">
            {{ _('Cancel') }}
        </button>
        <button id="proceed-to-summary" 
                class="order-action-button order-total-button"
                data-template="{{ _('Total %(total).2f %(currency)s', total=0.00, currency=_('PLN')) }}"
                data-empty-cart-message="{{ _('Please add items to your order before proceeding.') }}"
                data-inactivity-message="{{ _('You have been inactive for a while. Do you want to continue your order?') }}">
            {{ _('Total') }} {{ "%.2f"|format(0.00) }} {{ _('PLN') }}
        </button>
    </footer>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/order.js') }}"></script>
{% endblock %}
